import{o as i}from"./DvUShIk5.js";import{S as a,q as e}from"./0Y2rBl_W.js";const l=a((n,t)=>{console.log("Middleware auth ejecut√°ndose...");const r=sessionStorage.getItem("token");if(!r)return console.log("No token encontrado, redirigiendo a login"),e("/login");try{const o=i(r);if(console.log("Token decodificado:",o),o.exp*1e3<Date.now())return console.log("Token expirado, borrando y redirigiendo a login"),sessionStorage.removeItem("token"),e("/login");if(n.path==="/view"&&o.role!=="admin")return console.log("Acceso no autorizado a /view para el usuario, redirigiendo a /not-authorized"),e("/not-authorized");if(n.path==="/page"&&o.role==="admin")return console.log("Acceso no autorizado a /page para admin, redirigiendo a /not-authorized"),e("/not-authorized")}catch(o){return console.log("Error decodificando token:",o),sessionStorage.removeItem("token"),e("/login")}});export{l as default};
